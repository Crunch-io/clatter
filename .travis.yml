branches:
  only:
  - master
language: go
go:
- 1.7.1
before_script:
- git clone https://${GH_TOKEN}@github.com/$TRAVIS_REPO_SLUG.git $TRAVIS_REPO_SLUG
- cd $TRAVIS_REPO_SLUG
- git checkout -qf $TRAVIS_BRANCH
- git clone --branch v2 https://github.com/go-yaml/yaml $GOPATH/src/gopkg.in/yaml.v2
- go get -u -v github.com/spf13/hugo
- git config --global user.email "systems+crunchbot@crunch.io"
- git config --global user.name "Crunchbot"
script:
- git clone https://github.com/jeblister/kube.git ./themes/kube
- hugo
after_success:
- git clone https://${GH_TOKEN}@github.com/Crunch-io/ta-da.git ../ta-da
- cp -r public ../ta-da/dev
- git checkout gh-pages
- cp -r public/* .
- rm -rf public
- git add .
- git commit -m "Updating gh-pages" || true
- git push origin gh-pages > /dev/null 2>&1 || true
- cd ../ta-da
- git add .
- git commit -m "Updating dev blog" || true
- git push origin master > /dev/null 2>&1 || true
env:
  global:
    secure: D1wr7HoDVZBQ+e7bU/mHbtrv+6WQrGFCIl1S4XsyJEpgwa4Aiv1GhYW6GXLIQnr0qsd9YD3buChX/J8mx9qn4P/lNR3Jn25bPV+a5mDvvOniVBcKV93x0Se8uSGoZLJIA3CWEWix91nkMwSEVowMs6Sz5FLlbGya0jgMP/4JPJyYoNf+ajfpm5c3uFFO8JY81hSzD+7wgrzfWApqhMMLlJCH7f08d/FQBagGNnuDmCflG6Ltxek2fvXzP8UTrAyOYGExKNk9JWufh4+Oj7fCkuUifsjLl7hbMg3iithFDXiupbSoGokGuZRM5og2XmGs8eLzGKPi7S3gQM0UfmNUb5gMseTLNSDud3x7VqkTptOVh4rtm13TDHs2daVjFZ2oi/SBE7y1jKvnNDMn7wBgu+TkBcGU4cevd9uqmr6oYDKbeUH7crmlNOrCDhdEyWjji0lK0QqDyl0d1LiyiuJ9QIEWL8+dDpHxjB6V2fNdFSVG8nO1bk18qZgrx8Mris5lrJMCr9P5UkXlmoj4N4PKJeBR54B+Ytcto8QJKwAk+hmnNPAhKCW3AZ241NBoBO7mk+XJr4pVRn06RqnovIkZB/h3gIgJCmwc2JYrFXIeLcSccSAdyI90QgZGgo96mr6DJ1zih4mqvHGBNls+vVbPZsSd7DQHskUBfkYLk6g5w5Y=
